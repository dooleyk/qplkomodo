<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- qpl_menu_wizard_query.htm -->

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8;" />
	<link rel="stylesheet" type="text/css" href="qpl_help.css" />
	<title>Query Block</title>
</head>

<body>
	<p class="Printbar"><img alt="Print" src="../../skin/qpl_button_printer.png" onclick="window.print();" /></p>

	<h1>Query Block</h1>

<p>This dialog box may be used to create the QPL code for
one SQL query block. A query block may be embedded into the
text of a question (by putting its name inside curly braces ({})
where you want the query results to appear. Or it may be used to
create an answer list for an NLIST or SLIST question. Only one SELECT 
statement may be used in one QUERY block, but any number of QUERY 
blocks may be defined.</p>


<h2>Creating a Query Block That Will be Embedded in Question Text </h2>

<p>When using a QUERY block to embed a dynamically-generated list within the text 
of a question, the query output must have a column named "LABEL' which will be 
used for the list. The query may also include columns named "SOL" (start-of-line), 
and "EOL" (end-of-line) . The output of these columns should be HTML tags which 
will be used to format the LABEL output when displayed on the web page.</p>

<h3>Example</h3>

<p>SELECT [something AS 'SOL',] something AS 'LABEL' [, something AS 'EOL'] FROM mytable WHERE criteria ORDER BY criteria;</p>

<p>The query out put may also be formatted using the HTML Format fields (see below).</p>

<p>A QUERY block is embedded into the text of a question by using its name inside curly braces ({}). This will be replaced by the results of the query when the page is run on the web server.</p>

<p>Column names are case-sensitive (i.e., they must be written using all upper-case letters as shown above. Columns with other names are ignored.</p> 
 
<h2>Creating a Query Block for an NLIST or SLIST Question</h2>

<p>When using a QUERY block to set a dynamically-generated answer list to an NLIST or SLIST 
question, the query output must have a column named "LABEL," which will be used for the 
displayed list. It also must have a column named "VALUE," which will be used to code the 
label in the questionnaire database. This value must be numeric if you are using the NLIST 
question. And all the values used in the list must be greater than zero and unique.  The 
query may also include a "GROUP" column, which is used to label groups of answers in a 
drop-down list.</p>

<h3>Example</h3>

<p>SELECT [something AS 'GROUP',] something AS 'LABEL', something AS 'VALUE' FROM mytable WHERE criteria ORDER BY criteria;</p>

<p>The HTML Format fields below are not used for NLIST and SLIST queries.</p>

<p>Column names are case-sensitive (i.e., they must be written using all upper-case letters as shown above. Columns with other names are ignored.</p>


<table cellspacing="2" cellpadding="2" border="0">
<tr>
	<th colspan=2>Query Block
	</th>
</tr>
<tr>
	<th width="10%" valign="top" align="left">Name</th>
	<td width="90%" valign="top">The name of a query block must start with a letter, contain only letters and numbers, and be from one to sixteen characters long.<br><br>
	If a name is not specified, then the name 'QUERY#' will be created automatically.</td>
</tr>
<tr>
	<th colspan=2>HTML Formats
	</th>
</tr>
<tr>
	<th width="10%" valign="top" align="left">Start of query</th>
	<td valign="top" align="left">Enter HTML tag that will be used before query is output (Ex. &lt;PRE&gt;).
	</td>
</tr>
<tr>
	<th width="10%" valign="top" align="left">Start of line</th>
	<td valign="top" align="left">Enter HTML tag that will be used before each line of output (Ex. &lt;B&gt;).
	</td>
</tr>
<tr>
	<th width="10%" valign="top" align="left">End of line</th>
	<td valign="top" align="left">Enter HTML tag that will be used after each line of output (Ex. &lt;/B&gt;).
	</td>
</tr>
<tr>
	<th width="10%" valign="top" align="left">End of query</th>
	<td valign="top" align="left">Enter HTML tag that will be used after query is output (Ex. &lt;/PRE&gt;).
	</td>
</tr>
<tr>
	<th width="10%" valign="top" align="left">Empty query</th>
	<td valign="top" align="left">Enter phrase that will be displayed if the query generates no results. (Ex. &lt;I&gt;No results!&lt;/I&gt;)
	</td>
</tr>

<tr>
	<th colspan=2>Query
	</th>
</tr>

<tr>
	<th width="10%" valign="top" align="left">SET</th>
	<td valign="top" align="left">Initialize any needed MySQL user defined variables. Do not include the 'SET' command
	itself. You may define more than one variable by separating the declarations with a comma. (Ex. @count1 := 0, @count2 := 0)
	</td>
</tr>

<tr>
	<th width="10%" valign="top" align="left">Query</th>
	<td valign="top" align="left">Enter one SELECT query here. The query must start with 'SELECT.' See notes above for
	required column names.
	</td>
</tr>


</table>	

	
<!--	<p>See also <a href="qpl_menu_wizard_text_formatting.htm">Text Line Formatting.</a></p> -->

		
	<p align="center"><img alt="QPL6 Logo" src="../../skin/qplwrapper.png" /></p>

</body>
</html>
